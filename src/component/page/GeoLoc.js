// App.js
import React, { useState, useRef } from 'react';
import SlidingPane from 'react-sliding-pane';
import 'react-sliding-pane/dist/react-sliding-pane.css';
import { MapContainer, TileLayer, Marker, Popup, Polygon, Tooltip } from 'react-leaflet';
import L from 'leaflet';
import 'leaflet/dist/leaflet.css';
import './GeoLoc.css';

// Custom icon
const customIcon = new L.Icon({
  iconUrl: require('./marker.png'),
  iconSize: [32, 32],
  iconAnchor: [16, 32],
  popupAnchor: [0, -32],
});

const App = () => {
  const [state, setState] = useState({
    isPaneOpen: false,
    selectedMarker: null,
  });

  const [markers, setMarkers] = useState([
    { id: 1, position: { lat: 14.10051, lng: 122.96002 } },
    // Add other markers as needed
  ]);

  const [userLocation, setUserLocation] = useState(null);
  const mapRef = useRef(null); // Reference to the map instance
  const ZOOM_LEVEL = 10; // Adjust the desired zoom level

  const getUserLocation = () => {
    // ... (existing code)
  };

  const handleMapClick = () => {
    setState({ isPaneOpen: false, selectedMarker: null });
  };

  const handleMarkerClick = (marker) => {
    setState({ isPaneOpen: true, selectedMarker: marker });
  };
  const polygonCoords = [
    
    [14.0993506, 122.3044572],
    [14.0620538, 122.3017106],
    [14.0540608, 122.3484025],
    [14.0780389, 122.3923478],
    [14.1446314, 122.4362931],
    [14.0167566, 122.7878556],
    [13.8514796, 123.0570207],
    [13.8754788, 123.0789933],
    [13.8941431, 123.0872331],
    [13.9794464, 123.0899797],
    [14.0060972, 123.0432878],
    [14.0513964, 123.0240617],
    [14.0700465, 123.0432878],
    [14.0993506, 123.0460343],
    [14.1153331, 123.0048356],
    [14.1472947, 122.96913],
    [14.2191919, 122.9141984],
    [14.2724343, 122.8620133],
    [14.2857429, 122.8208146],
    [14.2910662, 122.7878556],
    [14.3096965, 122.7906022],
    [14.3256641, 122.7603898],
    [14.3230029, 122.7356706],
    [14.3256641, 122.7109513],
    [14.3389696, 122.6807389],
    [14.3203417, 122.667006],
    [14.2884046, 122.7054582],
    [14.3017123, 122.6422868],
    [14.2937277, 122.6203141],
    [14.3043737, 122.601088],
    [14.3256641, 122.5873551],
    [14.3389696, 122.5269303],
    [14.3150192, 122.5269303],
    [14.3336475, 122.4884782],
    [14.3309864, 122.450026],
    [14.3203417, 122.4280534],
    [14.3203417, 122.4280534],
  [14.2963893, 122.4211875],
  [14.2830813, 122.385482],
  [14.2538009, 122.3744956],
  [14.2538009, 122.3744956],
[14.2165294, 122.3580161],
[14.2218543, 122.3305503],
[14.1632738, 122.3360435],
[14.1366413, 122.3552696],
[14.0993506, 122.3044572],



    
  ];
  const polygonCoordsLabo = [
    
    
    [14.1446314, 122.4362931],
    [14.0167566, 122.7878556],
    [14.0167566, 122.7878556],
[14.039948, 122.8032256],
[14.1172064, 122.814212],
[14.1345193, 122.8293182],
[14.1491677, 122.833438],
[14.1691413, 122.8526641],
[14.1771302, 122.8403045],
[14.1891131, 122.8224517],
[14.2010953, 122.8320648],
[14.2010953, 122.8320648],
[14.2090831, 122.8224517],
[14.1984326, 122.8100921],
[14.2010953, 122.7743865],
[14.2117456, 122.7688934],
[14.2157394, 122.7510406],
[14.2024266, 122.7400543],
[14.2077518, 122.6741363],
[14.1771302, 122.6315643],
[14.2197331, 122.5628997],
[14.2130769, 122.4873687],
[14.1446314, 122.4362931],


  ];

const polygonCoordsSTE = [
  [14.1446314, 122.4362931],

[14.2130769, 122.4873687],



[14.2130769, 122.4873687],
[14.2087177, 122.4742383],
[14.2240269, 122.4852247],
[14.2266892, 122.4728651],
[14.2326794, 122.463252],
[14.2380039, 122.4550123],
[14.2426627, 122.4440259],
[14.2406661, 122.4357862],
[14.2539766, 122.4193067],
[14.2453249, 122.411067],
[14.2453249, 122.4021406],
[14.2593006, 122.376048],
[14.2538009, 122.3744956],
[14.2165294, 122.3580161],
[14.2218543, 122.3305503],
[14.1632738, 122.3360435],
[14.1366413, 122.3552696],
[14.0993506, 122.3044572],
[14.0993506, 122.3044572],
[14.0620538, 122.3017106],
[14.0540608, 122.3484025],
[14.0780389, 122.3923478],
[14.1446314, 122.4362931]


];

const polygonCoordsCPL = [
  [14.3311621, 122.5765485],

[14.3389696, 122.5269303],
[14.3150192, 122.5269303],
[14.3336475, 122.4884782],
[14.3309864, 122.450026],
[14.3203417, 122.4280534],
[14.3203417, 122.4280534],
[14.2963893, 122.4211875],
[14.2830813, 122.385482],

[14.2593006, 122.376048],

[14.2453249, 122.4021406],
[14.2453249, 122.411067],
[14.2539766, 122.4193067],
[14.2406661, 122.4357862],
[14.2426627, 122.4440259],
[14.2380039, 122.4550123],
[14.2326794, 122.463252],
[14.2266892, 122.4728651],
[14.2240269, 122.4852247],
[14.2087177, 122.4742383],
[14.2130769, 122.4873687],
    [14.2197331, 122.5628997],




[14.208052, 122.5841016],


];

const polygonCoordsJpg = [[14.208052, 122.5841016],




    [14.1771302, 122.6315643],
   
    
    [14.2077518, 122.6741363],
    [14.2024266, 122.7400543],
    [14.2459904, 122.7191917],
    [14.2506491, 122.741851],
    [14.3258398, 122.7150718],
    [14.3256641, 122.7109513],
    [14.3230029, 122.7356706],
    [14.3256641, 122.7109513],
    [14.3389696, 122.6807389],
    [14.3203417, 122.667006],
    [14.2884046, 122.7054582],
    [14.3017123, 122.6422868],
    [14.2937277, 122.6203141],
    [14.3043737, 122.601088],
    [14.3311621, 122.5765485],
    
];

const polygonCoordsPCL = [
  
  [14.2459904, 122.7191917],
  
  [14.2506491, 122.741851],
  [14.3258398, 122.7150718],
  [14.3230029, 122.7356706],
[14.3256641, 122.7603898],
[14.3096965, 122.7906022],
[14.2910662, 122.7878556],

  [14.2892457, 122.8009025],
[14.2819262, 122.805709],
[14.2759373, 122.8050223],
[14.2759373, 122.8194419],
[14.2857429, 122.8208146],
[14.2752718, 122.8517142],
  [14.2433283, 122.8771201],
  [14.2366728, 122.8736869],
  [14.2160396, 122.8778068],

  [14.2093833, 122.8771195],

  [14.2093833, 122.8771195],
  
  [14.2010953, 122.8320648],
  [14.2090831, 122.8224517],
  [14.1984326, 122.8100921],
  [14.2010953, 122.7743865],
  [14.2117456, 122.7688934],
  [14.2157394, 122.7510406],
  [14.2024266, 122.7400543],
];

const polygonCoordsVIN = [
  [14.1827562, 122.9417957],
[14.173436, 122.9390492],
[14.152797, 122.9287495],
[14.1414781, 122.9026569],
[14.128161, 122.8813709],

[14.128161, 122.8813709],
[14.1308245, 122.8765644],
[14.1361513, 122.8799976],
[14.1394806, 122.8717579],
[14.1394806, 122.8717579],
[14.1701073, 122.8621449],
[14.1754332, 122.867638],
[14.190079, 122.8655781],
[14.1874162, 122.8552784],
[14.1947388, 122.8628315],
[14.2073864, 122.8683247],
[14.2093833, 122.8771195],
[14.2160396, 122.8778068],
[14.2160396, 122.8778068],
[14.2366728, 122.8736869],
[14.2433283, 122.8771201],
[14.2752718, 122.8517142],

[14.2724343, 122.8620133],
[14.2191919, 122.9141984]
];

const polygonCoordsTAL = [
    
[14.144678, 122.9723635],

[14.1827562, 122.9417957],
[14.173436, 122.9390492],
[14.152797, 122.9287495],
[14.1414781, 122.9026569],
[14.128161, 122.8813709],
[14.1150468, 122.8903093],

];

const polygonCoordsDaet = [
  

  [14.144678, 122.9723635],
  [14.1150468, 122.8903093],

  [14.1150468, 122.8903093],
  [14.0996427, 122.8898223],
  [14.0869891, 122.9008087],
  [14.079663, 122.9121383],
  [14.080329, 122.9485305],
  [14.0769989, 122.9629501],
  [14.0949809, 122.9914459],
  [14.1346028, 122.9838928]
];

const polygonCoordsSLR = [
  [14.1150468, 122.8903093],
[14.1053213, 122.8487566],
[14.0870071, 122.8425768],
[14.0167566, 122.7878556],


[13.9296183, 122.9302401],
[13.993922, 122.9323001],
[14.0189057, 122.8931613],
[14.0798543, 122.9515262],



[14.079663, 122.9121383],
[14.0869891, 122.9008087],
[14.0996427, 122.8898223],
[14.1150468, 122.8903093]
];

const polygonCoordsBAS = [
  
[14.0513964, 123.0240617],
[14.0793536, 122.9538286],
[14.0793536, 122.9538286],
[14.0798543, 122.9515262],
[14.0189057, 122.8931613],
[13.993922, 122.9323001],
[13.9296183, 122.9302401],


[13.8904597, 122.9937533],
[13.916121, 123.0565814],
[13.967102, 123.0586413],
[13.9927548, 123.003023],
[14.0170724, 122.9989031],
[14.0250667, 123.0352954],

];

  return (
    <div>
      <SlidingPane
        className="some-custom-class"
        overlayClassName="some-custom-overlay-class"
        isOpen={state.isPaneOpen}
        title="PineApple Farm"
        subtitle="Daet, Camarines Norte"
        onRequestClose={() => {
          setState({ isPaneOpen: false, selectedMarker: null });
        }}
        from="left"
        width="300px"
      >
        <div>
          <p>Information about the pineapple </p>
        </div>
        <br />
        
      </SlidingPane>

      <div className={`map-container ${state.isPaneOpen ? 'map-container-open' : ''}`}>
        <MapContainer
          center={
            markers.length > 0 ? markers[markers.length - 1].position : { lat: 0, lng: 0 }
          }
          zoom={ZOOM_LEVEL}
          style={{
            height: '100%',
            width: '100%',
            position: 'absolute',
          }}
          ref={mapRef}
          onClick={handleMapClick}
        >
          <TileLayer url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png" />

          {/* Markers */}
          {markers.map((marker) => (
            <Marker
              key={marker.id}
              position={marker.position}
              icon={customIcon}
              eventHandlers={{
                click: () => handleMarkerClick(marker),
              }}
            />
          ))}

          {/* Marker for the user's location */}
          {userLocation && (
            <Marker key="user" position={userLocation} icon={customIcon} />
          )}

          {/* Polygon overlay */}
          
          <Polygon positions={polygonCoordsLabo} color="red"><Tooltip direction="top" offset={[0, -20]}>
    Labo
  </Tooltip></Polygon>
          <Polygon positions={polygonCoordsSTE} color="brown"><Tooltip direction="top" offset={[0, -20]}>
    Santa Elena
  </Tooltip></Polygon>
          <Polygon positions={polygonCoordsCPL} color="yellow"><Tooltip direction="top" offset={[0, -20]}>
    Capalonga
  </Tooltip></Polygon>
          <Polygon positions={polygonCoordsJpg} color="black"><Tooltip direction="top" offset={[0, -20]}>
    Jose Panganiban
  </Tooltip></Polygon>
          <Polygon positions={polygonCoordsPCL} color="brown"><Tooltip direction="top" offset={[0, -20]}>
    Paracale
  </Tooltip></Polygon>
          <Polygon positions={polygonCoordsVIN} color="orange"><Tooltip direction="top" offset={[0, -20]}>
    Vinzons
  </Tooltip></Polygon>
          <Polygon positions={polygonCoordsTAL} color="green"><Tooltip direction="top" offset={[0, -20]}>
    Talisay
  </Tooltip></Polygon>
          <Polygon positions={polygonCoordsDaet} color="red"><Tooltip direction="top" offset={[0, -20]}>
    Daet
  </Tooltip></Polygon>
          <Polygon positions={polygonCoordsSLR} color="yellow"><Tooltip direction="top" offset={[0, -20]}>
    San Lorenzo Ruiz
  </Tooltip></Polygon>
          <Polygon positions={polygonCoordsBAS} color="brown"><Tooltip direction="top" offset={[0, -20]}>
    Basud
  </Tooltip></Polygon>

        </MapContainer>
      </div>
    </div>
  );
};

export default App;
